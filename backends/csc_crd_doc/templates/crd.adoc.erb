= <%= crd.name %> Certification Requirements Document

== Revision History

|===
| Date | Revision | Changes

<%- crd.family.revisions.each do |rev| -%>
| <%= rev.date %> | <%= rev.version %>
| <%- rev.changes.each do |change| %>
 * <%= change %>
<%- end -%>
<%- end -%>
|===

== Introduction

=== <%= crd.family.name %> Family

<%= crd.family.overview %>

=== <%= crd.name %> Requirements

<%= crd.name %> is version <%= crd.version %> of the <%= crd.family.name %> Family.

<%= crd.description %>

== Specification Versions

TSC Profile:: <%= crd.tsc_profile.nil? ? "No profile" : crd.tsc_profile.marketing_name %>
Unpriv ISA Manual Revision:: <%= crd.unpriv_isa_manual_revision %>
Priv ISA Manual Revision:: <%= crd.priv_isa_manual_revision %>
Debug Manual Revision:: <%= crd.debug_manual_revision %>

== Requirements

=== Privileged Modes

|===
| M | S | U | VS | VU

| <%- if crd.family.mandatory_priv_modes.include?('M') -%> MANDATORY <%- else -%> OUT_OF_SCOPE <%- end -%>
| <%- if crd.family.mandatory_priv_modes.include?('S') -%> MANDATORY <%- else -%> OUT_OF_SCOPE <%- end -%>
| <%- if crd.family.mandatory_priv_modes.include?('U') -%> MANDATORY <%- else -%> OUT_OF_SCOPE <%- end -%>
| <%- if crd.family.mandatory_priv_modes.include?('VS') -%> MANDATORY <%- else -%> OUT_OF_SCOPE <%- end -%>
| <%- if crd.family.mandatory_priv_modes.include?('VU') -%> MANDATORY <%- else -%> OUT_OF_SCOPE <%- end -%>

|===

=== Extensions

==== MANDATORY Extensions

[%autowidth]
|===
| Extension | Version

<%- crd.mandatory_extensions.each do |ext| -%>
| <%= ext.name %>
| <%= ext.version_requirement %>
<%- end -%>
|===

==== OPTIONAL Extensions

<%- if crd.optional_extensions.empty? -%>
None
<%- else -%>
[%autowidth]
|===
| Extension | Version

<%- crd.optional_extensions.each do |ext| -%>
| <%= ext.name %>
| <%= ext.version_requirement %>
<%- end -%>
|===
<%- end -%>

==== OUT OF SCOPE Extensions
Any extension not listed above as MANDATORY or OPTIONAL is OUT OF SCOPE.

=== Extension Parameters

==== IN SCOPE Parameters

Parameters listed in this section are IN SCOPE (i.e., they'll be covered by the associated certificate).

[%autowidth]
|===
| Parameter | Extension | Constraint | Note

<%- crd.in_scope_param_constraints.each do |constraint| -%>
| <%= constraint.param.name %>
| <%= constraint.param.exts.map(&:name).join(', ') %>
| <%= constraint.schema_constraint_pretty == "" ? "Unconstrained" : constraint.schema_constraint_pretty %>
a| <%= constraint.note %>
<%- end -%>
|===

==== OUT OF SCOPE Parameters

Parameters listed in this section are OUT OF SCOPE (i.e., they won't be covered by the associated certificate).

[%autowidth]
|===
| Parameter | Extension | Description

<%- crd.out_of_scope_param_constraints.each do |param| -%>
| <%= param.name %>
| <%= param.exts.map(&:name).join(', ') %>
a| <%= param.desc %>
<%- end -%>
|===
<%- crd.requirement_groups.each do |group| -%>
=== <%= group.name %>

<%= group.description %>

<%- unless group.when.nil? -%>
[IMPORTANT]
<%= group.name %> requirements only apply when <%= group.when_pretty %>.
<%- end -%>

[%autowidth]
|===
| Name | Description

<%- group.requirements.each do |req| -%>
| <%= req.name %>
a| <%= req.description %>
<%- unless req.when.nil? -%>
[IMPORTANT]
Requirement <%= req.name %> only apply when <%= req.when_pretty %>.
<%- end -%>
<%- end -%>
|===

<%- end -%>

[appendix]
== Extensions
TBD - Mainly here to allow long descriptions of parameters to be displayed outside the IN SCOPE parameter table.